<div>
  <label for="color-picker-{{index +1}}" >Color Channel {{index +1}}</label>
  <div class="color-picker-wrapper">
    <div class="input-group">
      <input type="text"
        id="color-picker-{{index +1}}"
        [value]="
          'rgba(' +
          color?.red +
          ', ' +
          color?.green +
          ', ' +
          color?.blue +
          ', ' +
          (color?.alpha ? color.alpha : 1) +
          ')'
        "
        [ngStyle]="{
          'background-color':
            'rgba(' +
            color?.red +
            ', ' +
            color?.green +
            ', ' +
            color?.blue +
            ', ' +
            (color?.alpha ? color.alpha : 1) +
            ')',
          color:
            'rgba(' +
            (color?.red !== undefined ? (color?.red > 127 ? 0 : 255) : 0) +
            ', ' +
            (color?.green !== undefined ? (color?.green > 127 ? 0 : 255) : 0) +
            ', ' +
            (color?.blue !== undefined ? (color?.blue > 127 ? 0 : 255) : 0) +
            ', ' +
            1 +
            ')'
        }" readonly="readonly" class="form-control" />
      <div class="input-group-append">
        <button class="btn btn-secondary" type="button" (click)="isModalVisable = !isModalVisable">Change Color</button>
      </div>
    </div>
  </div>
  <div class="modal fade" 
  id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel"
  [attr.aria-hidden]="!isModalVisable"
  [ngClass]="{ 'show': isModalVisable, 'd-block': isModalVisable }"
  aria-modal="true"
  role="dialog" >
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">Color Channel {{index +1}}</h5>
          <button type="button" class="btn-close" aria-label="Close" (click)="isModalVisable = false" ><i class="fas fa-times"></i></button>
        </div>
        <div class="d-flex flex-row mt-3 mb-3">
          <div class="slider">
            <canvas width="300" height="300" class="border m-2" #canvasColorPicker style="background-image: none;" [ngStyle]="{'backgroundColor': rawHueAsHex()}" ></canvas>
            <div #canvasLightenPickerValue
              tabindex="0"
              role="slider"
              class="sr-only-thumb-v m-2"
              aria-valuemin="0"
              attr.aria-valuenow="{{hsva.s * 100}}"
              aria-valuemax="100"
              aria-orientation="vertical"
              aria-label="Lighten Color"
              [ngStyle]="{'right': luminosityToSliderPosition(), 'border-color':
              'rgb(' +
              (color?.red !== undefined ? (color?.red > 127 ? 0 : 255) : 0) +
              ', ' +
              (color?.green !== undefined ? (color?.green > 127 ? 0 : 255) : 0) +
              ', ' +
              (color?.blue !== undefined ? (color?.blue > 127 ? 0 : 255) : 0) +
              ')'}" ></div>
            <div #canvasDarkenPickerValue
              tabindex="0"
              role="slider"
              class="sr-only-thumb-h m-2"
              aria-valuemin="0"
              attr.aria-valuenow="{{hsva.v * 100}}"
              aria-valuemax="100"
              aria-orientation="horizontal"
              aria-label="Darken Color"
              [ngStyle]="{'top': saturationToSliderPosition(), 'border-color':
              'rgb(' +
              (color?.red !== undefined ? (color?.red > 127 ? 0 : 255) : 0) +
              ', ' +
              (color?.green !== undefined ? (color?.green > 127 ? 0 : 255) : 0) +
              ', ' +
              (color?.blue !== undefined ? (color?.blue > 127 ? 0 : 255) : 0) +
              ')'}" ></div>
            <div #canvasColorPickerValue
              class="thumb-multi rounded-circle"
              aria-label="Color Chroma"
              [ngStyle]="{'right': luminosityToSliderPosition(), 'top': saturationToSliderPosition(),
                'background-color':
                  'rgb(' +
                  color?.red +
                  ', ' +
                  color?.green +
                  ', ' +
                  color?.blue +
                  ')'}" ></div>
          </div>
          <div class="slider mt-2 mb-2" >
            <canvas width="10" height="300" class="border rounded-pill ml-3 mr-2" #canvasAlphaPicker ></canvas>
            <div #canvasAlphaPickerValue
              tabindex="0"
              role="slider"
              class="thumb-v rounded-pill"
              aria-valuemin="0"
              attr.aria-valuenow="{{hsva.a * 100}}"
              aria-valuemax="100"
              aria-orientation="vertical"
              aria-label="Alpha"
              (keydown)="alphaSlider.handleKeyDown($event)"
              [ngStyle]="{
                'top': alphaToSliderPosition()
              }" >
              <div [ngStyle]="{
                'background-color':
                  'rgba(' +
                  color?.red +
                  ', ' +
                  color?.green +
                  ', ' +
                  color?.blue +
                  ', ' +
                  (color?.alpha ? color.alpha : 1) +
                  ')'
              }" ></div>
            </div>
          </div>
          
        </div>
        <div class="d-flex flex-row mt-3 mb-3">
          <div class="slider ml-2">
            <canvas width="300" height="10" class="border rounded-pill mt-2 mb-2" #canvasHuePicker ></canvas>
            <div #canvasHuePickerValue
              tabindex="0"
              role="slider"
              class="thumb-h rounded-pill"
              aria-valuemin="0"
              attr.aria-valuenow="{{hueValueNow()}}"
              aria-valuemax="255"
              aria-orientation="horizontal"
              aria-label="Hue"
              (keydown)="hueSlider.handleKeyDown($event)"
              [ngStyle]="{'left': hueToSliderPosition(), 'backgroundColor': rawHueAsHex()}"></div>
          </div>

      </div>
    </div>
  </div>
</div>